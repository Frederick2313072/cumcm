# AI生成音乐检测与评价系统

## 项目概述

本项目基于**数学特征分析**构建了一个端到端的AI生成音乐检测与评价系统，重点关注特征提取的数学性和模型的可解释性。

## 核心创新

### 1. 基于真实数据训练
- 使用附件六提供的真实AI和人类音乐数据
- AI类别：alice, china_vocaloid, game, gugugaga, ikun, manbo, yiwu
- 人类类别：hanser, tianyi_daddy, xiangsi, xiexiemiao~
- 自动平衡数据集，避免类别偏向

### 2. 数学特征体系

#### A. 频域数学特征
- **谱质心分布规律性**: 分析AI音乐在频谱质心分布上的数学规律
- **谐波-噪声比模型**: 基于离散傅里叶变换的谐波成分分析
- **频谱包络平滑度**: 使用数学形态学分析频谱特征

#### B. 时域数学特征  
- **动态范围数学模型**: 分析音频动态范围的统计分布
- **微时间结构周期性**: 基于自相关函数的微观结构分析
- **能量分布熵模型**: 建立时间轴上的能量分布数学模型

#### C. 音乐学数学特征
- **节拍一致性数学指标**: 量化节拍模式的数学稳定性
- **调性稳定性分析**: 基于色度特征的数学分析
- **MFCC系数相关性**: 分析倒谱系数间的数学关系

### 3. 可解释集成模型

采用三种高可解释性模型的集成:
- **随机森林**: 提供特征重要性排序
- **逻辑回归**: 明确的数学关系建模
- **支持向量机**: 清晰的决策边界

## 文件结构

```
├── ai_music_detector.py     # 核心检测模型
├── val.py                   # 一键运行脚本  
├── process_attachments.py   # 处理附件音频文件
└── README.md               # 说明文档
```

## 使用方法

### 方法1: 处理比赛附件（推荐）

```bash
# 激活环境
source env/bin/activate

# 测试音频文件是否正确读取
python3 process_attachments.py test

# 处理附件一中的150个音频文件（已解压）
python3 process_attachments.py
```

### 方法2: 一键检测脚本

```bash  
# 创建val_music文件夹并放入待检测的MP3/AAC文件
mkdir val_music
# 将音频文件放入val_music文件夹

# 运行检测
python3 val.py
```

### 方法3: 快速测试

```bash
# 测试单个文件检测
python3 ai_music_detector.py test

# 完整训练和特征重要性分析
python3 ai_music_detector.py
```

## 数学原理

### 特征设计原理

1. **谱质心规律性**
   ```
   regularity = 1 / (1 + std(diff(spectral_centroids)))
   ```
   AI音乐的谱质心变化更规律，人类音乐变化更随机

2. **谐波-噪声比**
   ```  
   HNR = harmonic_energy / (percussive_energy + ε)
   ```
   AI音乐倾向于更高的谐波成分比例

3. **微周期性分析**
   ```
   periodicity = 1 / (1 + std(peak_intervals) / mean(peak_intervals))
   ```
   通过自相关分析微观时间结构的周期性

### 质量评分模型

AI音乐质量评分基于四个维度：
- 谐波质量 (30%)
- 音乐结构合理性 (25%) 
- 动态特征自然度 (25%)
- AI置信度调节 (20%)

## 技术优势

### 1. 数学可解释性
- 每个特征都有明确的数学定义
- 基于音频信号处理的经典理论
- 特征重要性可量化分析

### 2. 计算效率
- 避免深度学习的黑盒问题
- 特征提取速度快
- 模型推理效率高

### 3. 鲁棒性设计
- 多维度特征互补
- 集成模型降低过拟合风险
- 异常值处理机制

## 实验结果

模型在真实数据上的交叉验证准确率约为85-92%，重点在于：

1. **特征重要性排序**：展示哪些数学特征对AI检测最关键
2. **可解释性分析**：每个预测都可以通过数学特征解释
3. **质量评分合理性**：基于音乐理论的多维度评分体系

## 环境依赖

```bash
pip install pandas openpyxl librosa scikit-learn matplotlib numpy scipy
```


## 注意事项

1. 本方案基于附件六真实训练数据，避免了合成数据的偏差
2. 重点关注数学特征的可解释性，而非单纯追求准确率  
3. 特征设计基于音频信号处理的数学原理
4. 模型集成策略确保了预测的稳定性和可解释性
5. 评分体系综合考虑了音乐质量的多个维度